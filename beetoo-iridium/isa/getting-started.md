### Инструкция по сборке проекта под **IRIDIUM**.
Пользователям Windows рекомендуется установить Git Credential Manager for Windows v1.12.0
https://github.com/Microsoft/Git-Credential-Manager-for-Windows/releases

#### Первая сборка проекта.
1. Перед началом работы над проектом необходимо скачать репозиторий на компьютер. В корневой папке всех проектов выполнить команду -
    `$ git clone https://bitbucket.org/beetoo/150408_luzhniki`
(для проекта Лужники).
В корневой папке появится папка 150408_luzhniki.

2. Перейти в папку проекта.
    `$ cd 150408_luzhniki`

3. Файлы интерфесов Iridium под разные панели находятся в папке ***./gui***.
Для проекта Лужники родительским проектом всех интерфейсов является проект  **ipad**.
Для проекта Жуковка родительским проектом всех интерфейсов является проект **pool1**.
4. Сборка родительского проекта. Перейти в папку ***./ipad*** и для установки требуемых npm пакетов выполнить команду -
    `$ npm install`

5. Все исходные файлы проекта (**fonts, icons, images, scripts, sounds, templates**) находятся в папке ***./src***.

6. Сборка **dev** версии проекта. 
  В папке ***./ipad*** выполнить команду -
      `$ grunt --target=dev`

 Выполнится сборка всех исходников в один **Iridium** файл с расширением ****.irpz***, который появится в папке ***./build***.

7. Проверить работу **.irpz** файла в редакторе и эмуляторе **Iridium**.

#### Редактирование проекта.
1. При необходимости можно править файлы исходников проекта (см. п.5 Первая сборка проекта).

  - Файлы скриптов **js** лежат в папке ***./src/scripts***.

   - Системные файлы, согласно структуре файла **irpz** лежат в файлах-шаблонах ***.def** в папке ***./src/templates***.
  - Дерево папок **irpz** в ***./src/templates/folders***
  - Дерево устройств в ***./src/templates/devices, devicestree, universaltree***
  - Списки шрифтов, иконок и картинок в ***./src/templates/fonts, icons, images***
  - Настройки связей и переменные в ***./src/templates/relations, tokens***

  - Графическая структура **irpz** описывается кодом **xml** в файле ***./src/templates/popups.def*** или разбивается на отдельные ***.def** файлы, согласно помещениям -
  ***./src/templates/pool, barbershop, bedroom1, bathroom1 и т.д.***
2. Также изменения в графическую часть **irpz** можно вносить с помощью программы **Iridium GUI Editor**. После сменить расширение ***.irpz** на ***.zip**, распаковать и перенести составляющие кода файла **Project.irp** в соответствующие файлы-шаблоны ***.def**.

3. Сборка проекта см. п.6 Первая сборка проекта.

4. После успешного тестирования сборка **production** версии проекта командой - 
    `$ grunt concrete`
**!!! Перед сборкой необходимо увеличить версию проекта в файле package.json, а также убедиться в наличии файла concretecreds.json и актуальных данных в полях production_license, salt, ssh, hwid**.

Сборка дочерних интерфейсов согласно пункту 4 Первая сборка проекта, но в соответствующих папках **(iphone, mini, wallpc)**. Перед сборкой необходимо файл **package.json** родительского проекта **ipad** скопировать в папку ***./node_modules/Luzhniki-ipad*** дочернего проекта.